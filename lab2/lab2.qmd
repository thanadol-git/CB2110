---
title: "Lab 1"
format: 
  html:
    toc: true
    code-fold: true
    theme: lumen
---

Welcome back to the lab again. From last week, you may have worked with mass spectrometry data and processed a bit of them by yourself. This lab will look into the results that you have make and we will practice a bit of data wrangling and visualization with R. So, you can now understand the dataset much better with a much bigger view. As usual, please fill in your information here so we can give you nice some nice scores later. 

- Member1:
- Member2: 
- Contact email: 

Same here, there will be ten questions and three bonus questions for you to answer. Please try to elaborate this exercise with the lectures from the first week. The main goal of this lab is that you are not afraid to work with mass spectrometry. You will understand mass spectrometry much better. 


## Intended learning outcomes (ILOs) 

On completion of the lab, the student should be able to:
1. demonstrate data-processing procedures in mass spectrometry proteomics
2. demonstrate the ability to answer statistical questions with computational tools in mass spectrometry
3. identify quality of high-throughput dataset and handle with statistical understandings
4. identify relevant issues in technologies and data with accessible visualization techniques

## Let's start! 

You may recall from what we have done in the first lab. Now, we want to look at them properly. Let's start with some basic R programming skill. So, please just copy the file and change the path below. 

```{r}
# Libraries ---- 
library(dplyr)
library(ggplot2)
library(tidyverse)
library(stringr)

# File path of 
path <- '/home/thanadol/Documents/GitHub/CB2110/lab2/sdrf_openms_design_msstats_in.csv'
ms_result <- read.csv(path)

```

# Data overview
Let's check how do your data look. You can do it basically by take a look at your dataset. 

```{r}
head(ms_result)
# or 
View(ms_result)
```
## Q1. 
**What do you see in the output file? What are the columns and the rows** 

Ans.

We can now check how many samples are there. These should be related to what you have with the SDRF file previously. 

```{r}
# Number of samples and what are they
ms_result %>% 
  select(Reference, Condition) %>% 
  distinct()
```

## Q2. Let's check the peptides, and which protein do they belong
```{r}
# Peptides and Protein 
# Extract a table of two columns with unique proteins and peptides

ms_result %>% 
  select(___) 
  distinct(___)

```

Ans. 

## BQ1. Can you show how many proteins containing with the same number of peptides for? For example, there are 20 proteins were detected with 2 peptides. 
```{r}
# Peptide per protein count

```

# Dynamic range
```{r}
ms_result %>% 
  ggplot(aes(x =reorder(PeptideSequence, Intensity, mean), y = Intensity, color = Reference)) +
  geom_point(alpha = .4) + 
  geom_line(aes(group = Reference)) +
  scale_y_log10() + 
  theme_minimal() +
  labs(x = "Peptides", y = "Intensity")+ 
  theme(legend.position = "none",
  axis.text.x = element_blank())
```

You now can see the dynamic range of every proteins that were detected. 

## Q3. Pick one protein with the most detected peptide and visulize it. Do every peptide has the same intensity. If not, why? 


```{r}
# Intensities of Protein with multiple peptides
# Hint: filter(ProteinName == "The Name")

```

Ans.

# Missing data 
Let's now visualize the data that you already have with their intensities. 

```{r}
ms_result %>% 
  ggplot(aes(x =PeptideSequence, y = Reference, color = Intensity)) +
  geom_point()


```